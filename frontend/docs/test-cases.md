# 📋 Loretrans 测试用例文档

**版本**: v2.0.0  
**测试负责人**: 高级QA工程师  
**更新日期**: 2024-07-03

---

## 🎯 测试用例分类

### 优先级定义
- **P0 (阻塞)**: 核心功能，必须通过，影响产品基本可用性
- **P1 (重要)**: 主要功能，影响用户体验，应该通过
- **P2 (一般)**: 辅助功能，可延后修复
- **P3 (低优)**: 边缘情况，影响较小

---

## 🔥 P0 核心功能测试用例

### TC001: 基础文本翻译功能
**测试目标**: 验证基本翻译功能正常工作  
**优先级**: P0  
**测试类型**: 功能测试

**前置条件**:
- 用户已登录
- 用户有足够积分或在免费额度内
- NLLB服务正常运行

**测试步骤**:
1. 导航到翻译页面
2. 在源文本框输入 "Hello world"
3. 选择源语言为 "English (en)"
4. 选择目标语言为 "Chinese (zh)"
5. 点击 "翻译" 按钮
6. 等待翻译完成

**预期结果**:
- 翻译结果显示中文文本
- 翻译时间 < 30秒
- 显示消费的积分数量
- 显示翻译方法 "hf-nllb-1.3b"

**测试数据**:
```
输入: "Hello world"
源语言: en
目标语言: zh
预期输出: "你好世界" (或类似准确翻译)
```

---

### TC002: 用户认证系统
**测试目标**: 验证用户登录注册功能  
**优先级**: P0  
**测试类型**: 功能测试

**测试步骤**:
1. 访问注册页面
2. 输入有效邮箱和密码
3. 提交注册表单
4. 验证邮箱 (如果启用)
5. 使用注册的账号登录
6. 验证登录状态

**预期结果**:
- 注册成功，收到确认信息
- 登录成功，显示用户信息
- 用户状态正确保存
- 积分余额正确显示

---

### TC003: 积分系统计费
**测试目标**: 验证积分计算和消费正确  
**优先级**: P0  
**测试类型**: 功能测试

**测试场景**:

#### 场景A: 免费额度内翻译
**测试数据**: 文本长度 ≤ 500字符
**预期结果**: 不消费积分，显示免费翻译

#### 场景B: 超出免费额度翻译
**测试数据**: 文本长度 = 1000字符
**预期结果**: 消费 50积分 ((1000-500) × 0.1)

#### 场景C: 积分不足
**测试数据**: 用户积分 < 所需积分
**预期结果**: 显示积分不足错误，提示充值

---

### TC004: 多语言界面支持
**测试目标**: 验证12种语言界面正确显示  
**优先级**: P0  
**测试类型**: 国际化测试

**测试语言列表**:
- English (en)
- 中文 (zh)
- Español (es)
- Français (fr)
- العربية (ar)
- हिन्दी (hi)
- Português (pt)
- Kreyòl Ayisyen (ht)
- ລາວ (lo)
- Kiswahili (sw)
- မြန်မာ (my)
- తెలుగు (te)

**测试步骤**:
1. 访问 `/{locale}` 路径
2. 验证页面语言设置
3. 检查关键UI元素翻译
4. 验证文本方向 (RTL for Arabic)
5. 测试语言切换功能

---

## 🔧 P1 重要功能测试用例

### TC005: NLLB服务集成
**测试目标**: 验证Hugging Face Space NLLB服务集成  
**优先级**: P1  
**测试类型**: 集成测试

**测试场景**:

#### 场景A: 正常翻译请求
**API端点**: `https://wane0528-my-nllb-api.hf.space/api/v4/translator`
**请求格式**:
```json
{
  "text": "Hello world",
  "source_language": "en",
  "target_language": "zh"
}
```

#### 场景B: 服务超时处理
**测试条件**: 模拟60秒超时
**预期结果**: 显示超时错误，自动退还积分

#### 场景C: 服务不可用
**测试条件**: 模拟503服务错误
**预期结果**: 显示服务不可用错误，自动退还积分

---

### TC006: 智能翻译模式
**测试目标**: 验证智能模式判断逻辑  
**优先级**: P1  
**测试类型**: 功能测试

**测试场景**:

#### 场景A: 短文本实时翻译
**测试数据**: 文本长度 < 500字符
**预期行为**: 立即翻译，不显示时间预估

#### 场景B: 长文本队列处理
**测试数据**: 文本长度 > 1500字符
**预期行为**: 显示时间预估，提示可离开页面

#### 场景C: 时间预估准确性
**验证指标**: 预估时间与实际时间误差 < 50%

---

### TC007: 错误恢复机制
**测试目标**: 验证翻译失败时的错误处理  
**优先级**: P1  
**测试类型**: 异常测试

**测试场景**:

#### 场景A: 部分翻译成功
**测试条件**: 模拟部分chunk翻译失败
**预期结果**: 
- 显示已完成的翻译结果
- 提供重试选项
- 显示成功率和价值保护信息

#### 场景B: 完全翻译失败
**测试条件**: 模拟所有翻译请求失败
**预期结果**:
- 显示友好错误信息
- 自动退还消费的积分
- 提供重试或联系支持选项

---

### TC008: 移动端响应式设计
**测试目标**: 验证移动端用户体验  
**优先级**: P1  
**测试类型**: UI/UX测试

**测试设备**:
- iPhone SE (375×667)
- iPhone 12 (390×844)
- Samsung Galaxy S21 (360×800)
- iPad (768×1024)

**测试要点**:
- 触摸目标大小 ≥ 44px
- 可折叠界面组件正常工作
- 文本输入体验流畅
- 翻译结果易于阅读

---

## 🎨 P2 用户体验测试用例

### TC009: 性能基准测试
**测试目标**: 验证应用性能指标  
**优先级**: P2  
**测试类型**: 性能测试

**性能指标**:
- First Contentful Paint < 1.8s
- Largest Contentful Paint < 2.5s
- First Input Delay < 100ms
- Cumulative Layout Shift < 0.1
- 翻译API响应时间 < 30s

**测试工具**: Lighthouse CI, Playwright Performance API

---

### TC010: 可访问性测试
**测试目标**: 验证应用可访问性合规  
**优先级**: P2  
**测试类型**: 可访问性测试

**测试标准**: WCAG 2.1 AA级别

**测试要点**:
- 键盘导航支持
- 屏幕阅读器兼容
- 颜色对比度 ≥ 4.5:1
- 表单标签正确关联
- 图片alt属性完整

---

### TC011: SEO优化验证
**测试目标**: 验证搜索引擎优化效果  
**优先级**: P2  
**测试类型**: SEO测试

**测试页面**:
- 首页 (/)
- 语言专用页面 (/creole-to-english等)
- 关于页面 (/about)

**验证要点**:
- Meta标签完整性
- 结构化数据 (Schema.org)
- 页面标题和描述
- 内部链接结构
- 移动端友好性

---

## 🔍 P3 边缘情况测试用例

### TC012: 极限数据测试
**测试目标**: 验证极限条件下的系统稳定性  
**优先级**: P3  
**测试类型**: 边界测试

**测试场景**:
- 最大文本长度 (10,000字符)
- 特殊字符和Unicode
- 空文本输入
- 非常长的单词
- 混合语言文本

---

### TC013: 并发用户测试
**测试目标**: 验证多用户并发使用  
**优先级**: P3  
**测试类型**: 负载测试

**测试配置**:
- 并发用户数: 50
- 测试时长: 10分钟
- 翻译请求频率: 每用户每分钟2次

**监控指标**:
- 响应时间分布
- 错误率
- 系统资源使用
- 数据库连接池状态

---

### TC014: 浏览器兼容性测试
**测试目标**: 验证跨浏览器兼容性  
**优先级**: P3  
**测试类型**: 兼容性测试

**测试浏览器**:
- Chrome (最新版本)
- Firefox (最新版本)
- Safari (最新版本)
- Edge (最新版本)
- 移动端浏览器

---

## 🛡️ 安全测试用例

### TC015: 认证安全测试
**测试目标**: 验证认证系统安全性  
**优先级**: P1  
**测试类型**: 安全测试

**测试场景**:
- JWT令牌安全性
- 会话管理
- 密码强度验证
- 暴力破解防护
- CSRF攻击防护

---

### TC016: 数据安全测试
**测试目标**: 验证数据传输和存储安全  
**优先级**: P1  
**测试类型**: 安全测试

**测试要点**:
- HTTPS强制使用
- 敏感数据加密
- SQL注入防护
- XSS攻击防护
- 数据脱敏处理

---

## 📊 测试执行计划

### 每日测试 (CI/CD)
- 单元测试 (Jest)
- 集成测试 (API测试)
- 代码质量检查 (ESLint, TypeScript)
- 安全扫描 (Snyk)

### 每周测试
- 完整E2E测试套件 (Playwright)
- 性能基准测试 (Lighthouse)
- 多语言界面测试
- 移动端兼容性测试

### 发布前测试
- 完整回归测试
- 用户验收测试
- 生产环境烟雾测试
- 性能压力测试

### 生产环境监控
- 健康检查 (/api/health)
- 关键用户流程监控
- 性能指标监控
- 错误率监控

---

## 📈 测试指标和报告

### 质量指标
- **代码覆盖率**: 目标 ≥ 80%
- **测试通过率**: 目标 ≥ 95%
- **缺陷密度**: 目标 < 1个/KLOC
- **平均修复时间**: 目标 < 24小时

### 性能指标
- **页面加载时间**: 目标 < 3秒
- **API响应时间**: 目标 < 30秒
- **系统可用性**: 目标 ≥ 99.9%
- **错误率**: 目标 < 1%

### 用户体验指标
- **翻译准确率**: 目标 > 90%
- **用户满意度**: 目标 > 4.5/5
- **任务完成率**: 目标 > 95%
- **用户留存率**: 目标 > 70%

---

## 🔧 测试工具和环境

### 测试工具栈
- **单元测试**: Jest + React Testing Library
- **E2E测试**: Playwright
- **API测试**: Supertest + Jest
- **性能测试**: Lighthouse CI
- **安全测试**: OWASP ZAP + Snyk
- **可访问性测试**: axe-core

### 测试环境
- **开发环境**: 本地开发测试
- **测试环境**: CI/CD自动化测试
- **预发环境**: 生产前验证
- **生产环境**: 监控和健康检查

---

**文档维护**: QA团队  
**更新频率**: 每次发布后更新  
**下次评审**: 2024-08-03
