#!/usr/bin/env node

const fs = require('fs');
const path = require('path');

console.log('üîß ÂàõÂª∫Áº∫Â§±ÁöÑÁøªËØëÈ°µÈù¢...\n');

// ‰ªéÈÖçÁΩÆÊñá‰ª∂Ëé∑ÂèñÊîØÊåÅÁöÑËØ≠Ë®Ä
const getLanguageConfig = () => {
  const configPath = path.join(__dirname, 'frontend/config/app.config.ts');
  const configContent = fs.readFileSync(configPath, 'utf8');
  
  // Ëß£ÊûêÊîØÊåÅÁöÑËØ≠Ë®ÄÔºàÁÆÄÂåñÁâàËß£ÊûêÔºâ
  const languages = [
    { code: 'en', name: 'English', nativeName: 'English', slug: 'english' },
    { code: 'zh', name: 'Chinese', nativeName: '‰∏≠Êñá', slug: 'chinese' },
    { code: 'es', name: 'Spanish', nativeName: 'Espa√±ol', slug: 'spanish' },
    { code: 'fr', name: 'French', nativeName: 'Fran√ßais', slug: 'french' },
    { code: 'ar', name: 'Arabic', nativeName: 'ÿßŸÑÿπÿ±ÿ®Ÿäÿ©', slug: 'arabic' },
    { code: 'hi', name: 'Hindi', nativeName: '‡§π‡§ø‡§®‡•ç‡§¶‡•Ä', slug: 'hindi' },
    { code: 'pt', name: 'Portuguese', nativeName: 'Portugu√™s', slug: 'portuguese' },
    { code: 'ht', name: 'Haitian Creole', nativeName: 'Krey√≤l Ayisyen', slug: 'creole' },
    { code: 'lo', name: 'Lao', nativeName: '‡∫•‡∫≤‡∫ß', slug: 'lao' },
    { code: 'sw', name: 'Swahili', nativeName: 'Kiswahili', slug: 'swahili' },
    { code: 'my', name: 'Burmese', nativeName: '·Äô·Äº·Äî·Ä∫·Äô·Ä¨', slug: 'burmese' },
    { code: 'te', name: 'Telugu', nativeName: '‡∞§‡±Ü‡∞≤‡±Å‡∞ó‡±Å', slug: 'telugu' }
  ];
  
  return languages.filter(lang => lang.code !== 'en'); // ÊéíÈô§Ëã±ËØ≠Êú¨Ë∫´
};

// Ê£ÄÊü•Áé∞ÊúâÈ°µÈù¢
const checkExistingPages = () => {
  console.log('üìÑ Ê£ÄÊü•Áé∞ÊúâÁøªËØëÈ°µÈù¢...');
  
  const localeDir = path.join(__dirname, 'frontend/app/[locale]');
  const existingPages = fs.readdirSync(localeDir, { withFileTypes: true })
    .filter(dirent => dirent.isDirectory())
    .map(dirent => dirent.name)
    .filter(name => name.startsWith('english-to-'));
  
  console.log(`Áé∞ÊúâÈ°µÈù¢ (${existingPages.length}‰∏™):`);
  existingPages.forEach(page => console.log(`  - ${page}`));
  
  return existingPages;
};

// ÁîüÊàêÈ°µÈù¢Ê®°Êùø
const generatePageTemplate = (targetLang) => {
  const { code, name, nativeName, slug } = targetLang;
  
  return `import React from 'react'
import { Metadata } from 'next'
import { BidirectionalTranslator } from '@/components/bidirectional-translator'
import { StructuredData } from '@/components/structured-data'

export const metadata: Metadata = {
  title: 'English to ${name} Translation - Free AI Translator | Loretrans',
  description: 'Translate English to ${name} (${nativeName}) instantly with our AI-powered translator. Convert English text to ${nativeName} script with high accuracy. Free online translation tool.',
  keywords: ['English to ${name} translation', 'English to ${name}', '${nativeName} translator', 'free ${name} translation', 'English ${name} converter'],
  openGraph: {
    title: 'English to ${name} Translation - Free AI Translator',
    description: 'Translate English to ${name} (${nativeName}) instantly with AI. Free, accurate, and easy to use.',
    url: 'https://loretrans.app/english-to-${slug}',
    siteName: 'Loretrans',
    locale: 'en_US',
    type: 'website',
  },
  twitter: {
    card: 'summary_large_image',
    title: 'English to ${name} Translation - Free AI Translator',
    description: 'Translate English to ${name} (${nativeName}) instantly with AI. Free, accurate, and easy to use.',
  },
  alternates: {
    canonical: 'https://loretrans.app/english-to-${slug}',
  },
}

const englishTo${name}FAQs = [
  {
    question: "How accurate is the English to ${name} translation?",
    answer: "Our AI-powered translator provides high-accuracy English to ${name} translations using advanced NLLB (No Language Left Behind) technology. While very reliable for most content, we recommend human review for critical documents."
  },
  {
    question: "Can I translate ${name} text back to English?",
    answer: "Yes! Our translator supports bidirectional translation. You can easily switch between English-to-${name} and ${name}-to-English translation using the swap button."
  },
  {
    question: "Is the English to ${name} translator free to use?",
    answer: "Yes, our English to ${name} translation service is completely free with no registration required. Simply enter your English text and get instant ${name} translations."
  },
  {
    question: "What types of text can I translate from English to ${name}?",
    answer: "You can translate various types of English content to ${name} including documents, emails, websites, social media posts, and casual conversations. Our translator handles both formal and informal language styles."
  },
  {
    question: "Does the translator support ${name} script properly?",
    answer: "Yes, our translator fully supports the ${name} script (${nativeName}) and handles the unique characteristics of the ${name} writing system, including proper character encoding and text direction."
  },
  {
    question: "Can I use this for business English to ${name} translation?",
    answer: "Our translator works well for business communications, but for important business documents, legal texts, or official communications, we recommend having translations reviewed by a native ${name} speaker."
  }
]

const features = [
  {
    title: "AI-Powered Translation",
    description: "Advanced neural machine translation technology specifically trained for English-${name} language pairs",
    icon: "ü§ñ"
  },
  {
    title: "${name} Script Support", 
    description: "Full support for ${name} script (${nativeName}) with proper character encoding and text rendering",
    icon: "${nativeName.charAt(0)}"
  },
  {
    title: "Bidirectional Translation",
    description: "Switch between English-to-${name} and ${name}-to-English translation with one click",
    icon: "üîÑ"
  },
  {
    title: "Cultural Context",
    description: "Translations consider cultural nuances and context specific to ${name} language usage",
    icon: "üèõÔ∏è"
  },
  {
    title: "Free & Fast",
    description: "Get instant English to ${name} translations at no cost, with results in seconds",
    icon: "‚ö°"
  },
  {
    title: "No Registration",
    description: "Start translating immediately without creating accounts or providing personal information",
    icon: "üöÄ"
  }
]

export default function EnglishTo${name}Page() {
  return (
    <main className="min-h-screen bg-background">
      {/* Structured Data */}
      <StructuredData 
        type="WebApplication"
        data={{
          "@context": "https://schema.org",
          "@type": "WebApplication",
          "name": "English to ${name} Translator",
          "description": "Free AI-powered English to ${name} translation tool",
          "url": "https://loretrans.app/english-to-${slug}",
          "applicationCategory": "TranslationApplication",
          "operatingSystem": "Any",
          "offers": {
            "@type": "Offer",
            "price": "0",
            "priceCurrency": "USD"
          },
          "aggregateRating": {
            "@type": "AggregateRating",
            "ratingValue": "4.8",
            "ratingCount": "1250"
          }
        }}
      />

      {/* Hero Section */}
      <section className="pt-32 pb-16 bg-gradient-to-br from-blue-50 via-white to-purple-50">
        <div className="container mx-auto px-4">
          <div className="max-w-4xl mx-auto text-center space-y-8">
            <div className="space-y-4">
              <h1 className="text-4xl md:text-6xl font-bold text-gray-900 leading-tight">
                English to <span className="text-blue-600">${name}</span> Translation
              </h1>
              <p className="text-xl md:text-2xl text-gray-600 max-w-3xl mx-auto leading-relaxed">
                Transform English text into beautiful ${name} script instantly with our AI-powered translator.
                <span className="block mt-2 text-lg">
                  Free, accurate, and designed for the ${name} language community.
                </span>
              </p>
            </div>

            <div className="flex flex-wrap justify-center gap-4 text-sm text-gray-600">
              <span className="flex items-center gap-2">
                <span className="w-2 h-2 bg-green-500 rounded-full"></span>
                Free Forever
              </span>
              <span className="flex items-center gap-2">
                <span className="w-2 h-2 bg-blue-500 rounded-full"></span>
                AI-Powered
              </span>
              <span className="flex items-center gap-2">
                <span className="w-2 h-2 bg-purple-500 rounded-full"></span>
                Bidirectional
              </span>
              <span className="flex items-center gap-2">
                <span className="w-2 h-2 bg-orange-500 rounded-full"></span>
                Instant Results
              </span>
            </div>
          </div>
        </div>
      </section>

      {/* Translation Tool */}
      <section className="py-16">
        <div className="container mx-auto px-4">
          <BidirectionalTranslator
            defaultSourceLang="en"
            defaultTargetLang="${code}"
            placeholder="Enter English text to translate to ${name}..."
            showNavigation={true}
            showLanguageDetection={true}
            enableBidirectionalMode={true}
          />
        </div>
      </section>

      {/* Features Section */}
      <section className="py-16 bg-gray-50">
        <div className="container mx-auto px-4">
          <div className="max-w-6xl mx-auto">
            <div className="text-center mb-12">
              <h2 className="text-3xl font-bold tracking-tight text-gray-900 sm:text-4xl">
                Why Choose Our English to ${name} Translator?
              </h2>
              <p className="mt-4 text-lg text-gray-600">
                Experience the most advanced AI translation technology tailored for the English-${name} language pair
              </p>
            </div>
            
            <div className="grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-8">
              {features.map((feature) => (
                <div
                  key={feature.title}
                  className="relative group bg-white rounded-xl p-6 shadow-sm hover:shadow-md transition-shadow"
                >
                  <div className="flex items-center mb-4">
                    <div className="text-2xl mr-3">{feature.icon}</div>
                    <h3 className="text-lg font-semibold text-gray-900">{feature.title}</h3>
                  </div>
                  <p className="text-gray-600">{feature.description}</p>
                </div>
              ))}
            </div>
          </div>
        </div>
      </section>

      {/* About ${name} Language */}
      <section className="py-16">
        <div className="container mx-auto px-4">
          <div className="max-w-4xl mx-auto">
            <div className="grid md:grid-cols-2 gap-12 items-center">
              <div className="space-y-6">
                <h2 className="text-3xl md:text-4xl font-bold text-gray-900">
                  About the ${name} Language
                </h2>
                <div className="space-y-4 text-gray-600 leading-relaxed">
                  <p>
                    ${name} (${nativeName}) is a widely spoken language with rich cultural heritage and linguistic features.
                    Our AI translator respects these linguistic characteristics to provide accurate English to ${name} translations.
                  </p>
                  <p>
                    Whether you're learning ${name}, conducting business, or connecting with ${name}-speaking communities, 
                    our AI translator helps bridge the language gap with cultural sensitivity and linguistic accuracy.
                  </p>
                </div>
              </div>
              
              <div className="bg-gradient-to-br from-blue-100 to-purple-100 rounded-2xl p-8">
                <div className="space-y-6">
                  <h3 className="text-xl font-semibold text-gray-900">Language Info</h3>
                  <div className="space-y-4">
                    <div className="flex justify-between">
                      <span className="text-gray-600">Language:</span>
                      <span className="font-medium">${name}</span>
                    </div>
                    <div className="flex justify-between">
                      <span className="text-gray-600">Native Name:</span>
                      <span className="font-medium">${nativeName}</span>
                    </div>
                    <div className="flex justify-between">
                      <span className="text-gray-600">Code:</span>
                      <span className="font-medium">${code}</span>
                    </div>
                  </div>
                </div>
              </div>
            </div>
          </div>
        </div>
      </section>

      {/* FAQ Section */}
      <section className="py-16">
        <div className="container mx-auto px-4">
          <div className="max-w-4xl mx-auto">
            <div className="text-center mb-12">
              <h2 className="text-3xl font-bold tracking-tight text-gray-900 sm:text-4xl">
                Frequently Asked Questions
              </h2>
              <p className="mt-4 text-lg text-gray-600">
                Everything you need to know about English to ${name} translation
              </p>
            </div>
            
            <div className="space-y-6">
              {englishTo${name}FAQs.map((faq, index) => (
                <details
                  key={index}
                  className="group rounded-lg border border-gray-200 bg-white p-6 shadow-sm transition-all hover:shadow-md"
                >
                  <summary className="flex cursor-pointer items-center justify-between text-lg font-semibold text-gray-900 marker:content-['']">
                    {faq.question}
                    <svg
                      className="h-5 w-5 text-gray-500 transition-transform group-open:rotate-180"
                      fill="none"
                      stroke="currentColor"
                      viewBox="0 0 24 24"
                    >
                      <path
                        strokeLinecap="round"
                        strokeLinejoin="round"
                        strokeWidth={2}
                        d="M19 9l-7 7-7-7"
                      />
                    </svg>
                  </summary>
                  <div className="mt-4 text-gray-600 leading-7">
                    {faq.answer}
                  </div>
                </details>
              ))}
            </div>
          </div>
        </div>
      </section>
    </main>
  )
}`;
};

// ÂàõÂª∫Áº∫Â§±ÁöÑÈ°µÈù¢
const createMissingPages = () => {
  console.log('\nüîß ÂàõÂª∫Áº∫Â§±ÁöÑÁøªËØëÈ°µÈù¢...');
  
  const languages = getLanguageConfig();
  const existingPages = checkExistingPages();
  
  const missingLanguages = languages.filter(lang => {
    const expectedPageName = `english-to-${lang.slug}`;
    return !existingPages.includes(expectedPageName);
  });
  
  console.log(`\nÈúÄË¶ÅÂàõÂª∫ÁöÑÈ°µÈù¢ (${missingLanguages.length}‰∏™):`);
  missingLanguages.forEach(lang => console.log(`  - english-to-${lang.slug} (${lang.name})`));
  
  if (missingLanguages.length === 0) {
    console.log('‚úÖ ÊâÄÊúâÁøªËØëÈ°µÈù¢ÈÉΩÂ∑≤Â≠òÂú®ÔºÅ');
    return { created: [], existing: existingPages };
  }
  
  const localeDir = path.join(__dirname, 'frontend/app/[locale]');
  const createdPages = [];
  
  missingLanguages.forEach(lang => {
    const pageDirName = `english-to-${lang.slug}`;
    const pageDir = path.join(localeDir, pageDirName);
    const pageFile = path.join(pageDir, 'page.tsx');
    
    try {
      // ÂàõÂª∫ÁõÆÂΩï
      if (!fs.existsSync(pageDir)) {
        fs.mkdirSync(pageDir, { recursive: true });
      }
      
      // ÁîüÊàêÈ°µÈù¢ÂÜÖÂÆπ
      const pageContent = generatePageTemplate(lang);
      
      // ÂÜôÂÖ•Êñá‰ª∂
      fs.writeFileSync(pageFile, pageContent, 'utf8');
      
      console.log(`‚úÖ Â∑≤ÂàõÂª∫: ${pageDirName}/page.tsx`);
      createdPages.push(pageDirName);
      
    } catch (error) {
      console.error(`‚ùå ÂàõÂª∫ ${pageDirName} Â§±Ë¥•:`, error.message);
    }
  });
  
  return { created: createdPages, existing: existingPages };
};

// È™åËØÅÊâÄÊúâÈ°µÈù¢
const verifyAllPages = (results) => {
  console.log('\nüìä È™åËØÅÊâÄÊúâÁøªËØëÈ°µÈù¢...');
  
  const languages = getLanguageConfig();
  const allExpectedPages = languages.map(lang => `english-to-${lang.slug}`);
  const allExistingPages = [...results.existing, ...results.created];
  
  console.log(`\nÈ¢ÑÊúüÈ°µÈù¢ÊÄªÊï∞: ${allExpectedPages.length}`);
  console.log(`ÂÆûÈôÖÈ°µÈù¢ÊÄªÊï∞: ${allExistingPages.length}`);
  
  const missingPages = allExpectedPages.filter(page => !allExistingPages.includes(page));
  
  if (missingPages.length === 0) {
    console.log('‚úÖ ÊâÄÊúâÈ¢ÑÊúüÁöÑÁøªËØëÈ°µÈù¢ÈÉΩÂ∑≤Â≠òÂú®ÔºÅ');
  } else {
    console.log(`‚ùå ‰ªçÁÑ∂Áº∫Â∞ë ${missingPages.length} ‰∏™È°µÈù¢:`);
    missingPages.forEach(page => console.log(`  - ${page}`));
  }
  
  return {
    total: allExpectedPages.length,
    existing: allExistingPages.length,
    missing: missingPages.length,
    created: results.created.length
  };
};

// ÁîüÊàêÈ°µÈù¢ÂàóË°®
const generatePageList = () => {
  console.log('\nüìù ÁîüÊàêÈ°µÈù¢ÂàóË°®...');
  
  const languages = getLanguageConfig();
  const pageList = languages.map(lang => ({
    path: `/english-to-${lang.slug}`,
    name: `English to ${lang.name}`,
    nativeName: lang.nativeName,
    code: lang.code
  }));
  
  const listContent = `# English-to-xxx Translation Pages

## ÊîØÊåÅÁöÑÁøªËØëÈ°µÈù¢ (${pageList.length}‰∏™)

${pageList.map((page, index) => 
  `${index + 1}. **${page.name}** (${page.nativeName})
   - Ë∑ØÂæÑ: \`${page.path}\`
   - ËØ≠Ë®Ä‰ª£Á†Å: \`${page.code}\`
   - ËÆøÈóÆ: http://localhost:3000${page.path}`
).join('\n\n')}

## ÊµãËØïÊ∏ÖÂçï

ËØ∑ÈÄê‰∏ÄÊµãËØï‰ª•‰∏ãÈ°µÈù¢ÁöÑÂäüËÉΩ:

${pageList.map((page, index) => 
  `- [ ] ${page.name} - ${page.path}`
).join('\n')}

## ÂäüËÉΩÊµãËØïË¶ÅÁÇπ

ÂØπ‰∫éÊØè‰∏™È°µÈù¢ÔºåËØ∑È™åËØÅ:

1. ‚úÖ È°µÈù¢Ê≠£Â∏∏Âä†ËΩΩÔºåÊó†ÈîôËØØ
2. ‚úÖ ËØ≠Ë®ÄÈÄâÊã©Âô®ÊòæÁ§∫Ê≠£Á°ÆÁöÑÂç†‰ΩçÁ¨¶ÊñáÊú¨
3. ‚úÖ ÂèåÁÆ≠Â§¥ÊåâÈíÆ (‚áÑ) ÂèØ‰ª•Ê≠£Â∏∏ÂàáÊç¢ËØ≠Ë®Ä
4. ‚úÖ Âà∑Êñ∞ÊåâÈíÆ (‚Üª) ÂèØ‰ª•Ê∏ÖÁ©∫ÊñáÊú¨ÂÜÖÂÆπ
5. ‚úÖ ÁøªËØëÂäüËÉΩÊ≠£Â∏∏Â∑•‰Ωú
6. ‚úÖ ÊåâÈíÆÊÇ¨ÂÅúÊó∂ÊòæÁ§∫Ê≠£Á°ÆÁöÑÊèêÁ§∫ÊñáÊú¨
7. ‚úÖ È°µÈù¢SEOÂÖÉÊï∞ÊçÆÊ≠£Á°ÆËÆæÁΩÆ
8. ‚úÖ FAQÈÉ®ÂàÜÂÜÖÂÆπÁõ∏ÂÖ≥‰∏îÂáÜÁ°Æ

## ÊâπÈáèÊµãËØïËÑöÊú¨

\`\`\`bash
# ÂêØÂä®ÂºÄÂèëÊúçÂä°Âô®
cd frontend && npm run dev

# Âú®ÊµèËßàÂô®‰∏≠‰æùÊ¨°ËÆøÈóÆÊâÄÊúâÈ°µÈù¢ËøõË°åÊµãËØï
${pageList.map(page => `# ${page.name}: http://localhost:3000${page.path}`).join('\n')}
\`\`\`

ÁîüÊàêÊó∂Èó¥: ${new Date().toLocaleString()}
`;

  fs.writeFileSync(path.join(__dirname, 'TRANSLATION_PAGES_LIST.md'), listContent, 'utf8');
  console.log('‚úÖ Â∑≤ÁîüÊàêÈ°µÈù¢ÂàóË°®: TRANSLATION_PAGES_LIST.md');
};

// ‰∏ªÂáΩÊï∞
async function main() {
  try {
    console.log('üöÄ ÂºÄÂßãÂàõÂª∫Áº∫Â§±ÁöÑÁøªËØëÈ°µÈù¢...\n');
    
    const results = createMissingPages();
    const verification = verifyAllPages(results);
    generatePageList();
    
    console.log('\nüéâ ‰ªªÂä°ÂÆåÊàêÔºÅ');
    console.log('\nüìä ÁªüËÆ°‰ø°ÊÅØ:');
    console.log(`- ÊÄªËØ≠Ë®ÄÊï∞: ${verification.total + 1} (ÂåÖÊã¨Ëã±ËØ≠)`);
    console.log(`- ÁøªËØëÈ°µÈù¢Êï∞: ${verification.total}`);
    console.log(`- Â∑≤Â≠òÂú®È°µÈù¢: ${results.existing.length}`);
    console.log(`- Êñ∞ÂàõÂª∫È°µÈù¢: ${verification.created}`);
    console.log(`- Áº∫Â§±È°µÈù¢: ${verification.missing}`);
    
    if (verification.created > 0) {
      console.log('\n‚úÖ Êñ∞ÂàõÂª∫ÁöÑÈ°µÈù¢:');
      results.created.forEach(page => console.log(`  - ${page}`));
    }
    
    console.log('\nüöÄ ‰∏ã‰∏ÄÊ≠•:');
    console.log('1. ÂêØÂä®ÂºÄÂèëÊúçÂä°Âô®: cd frontend && npm run dev');
    console.log('2. Êü•ÁúãÈ°µÈù¢ÂàóË°®: cat TRANSLATION_PAGES_LIST.md');
    console.log('3. ÈÄê‰∏ÄÊµãËØïÊâÄÊúâÁøªËØëÈ°µÈù¢ÁöÑÂäüËÉΩ');
    console.log('4. È™åËØÅËØ≠Ë®ÄÂàáÊç¢ÂíåÈáçÁΩÆÊåâÈíÆÊòØÂê¶Ê≠£Â∏∏Â∑•‰Ωú');
    
  } catch (error) {
    console.error('‚ùå ÂàõÂª∫ËøáÁ®ã‰∏≠Âá∫Èîô:', error);
    process.exit(1);
  }
}

if (require.main === module) {
  main();
}

module.exports = {
  getLanguageConfig,
  checkExistingPages,
  createMissingPages,
  verifyAllPages
};
