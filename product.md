# 🧩 产品名称：Transly — Translate Low-Resource Languages to English

## 🎯 产品定位
为全球小语种用户提供精准、高可用的"翻译成英文"工具，覆盖 20+ 低竞争语言，基于 Meta NLLB 模型，兼顾 SEO 流量与实用翻译体验。

---

## 🏗️ 产品结构

### 1. 多语种独立 Landing Pages
#### 1.1 小语种到英文翻译页面
- `/creole-to-english` - 海地克里奥尔语翻译页面（已完成）
- `/lao-to-english` - 老挝语翻译页面（已完成）
- `/swahili-to-english` - 斯瓦希里语翻译页面（已完成）
- `/burmese-to-english` - 缅甸语翻译页面（已完成）
- `/telugu-to-english` - 泰卢固语翻译页面（已完成）

#### 1.2 英文到小语种翻译页面（新增）
- `/english-to-creole` - 英文到海地克里奥尔语翻译页面
- `/english-to-lao` - 英文到老挝语翻译页面
- `/english-to-swahili` - 英文到斯瓦希里语翻译页面
- `/english-to-burmese` - 英文到缅甸语翻译页面
- `/english-to-telugu` - 英文到泰卢固语翻译页面

#### 1.3 特殊功能
- 每个页面都包含语言切换按钮，支持双向翻译切换
- 独立SEO优化，包含完整的Schema.org结构化数据
- 暂不支持的语言显示"Coming Soon"页面
- 页面间相互链接，提升用户体验和SEO价值

### 2. 首页 `/`
- 产品介绍与品牌展示
- 多种翻译形式概览（Text翻译、Document翻译、图片翻译Coming Soon）
- 推荐翻译语言入口
- FAQ
- 站点地图/所有语种链接集合

### 3. 文本翻译页面 `/text-translate`
- 独立的文本翻译功能页面
- 语言选择器与翻译界面
- 翻译历史记录（本地存储）
- 快捷复制与TTS功能

### 4. 关于页面 `/about`
- 产品介绍与优势
- 支持的语言列表
- 使用帮助与FAQ

### 5. 用户系统页面（新增）
- `/auth/signin` - 登录页面
- `/auth/signup` - 注册页面
- `/auth/verify` - 邮箱验证页面
- `/dashboard` - 用户控制台
- `/pricing` - 定价页面
- `/credits/purchase` - 积分充值页面
- `/profile` - 用户资料页面

---

## 🔐 用户系统与身份验证

### 身份验证方案
**技术方案：Supabase Auth + Supabase PostgreSQL**
- **Supabase Auth**：现代化身份验证服务
  - 邮箱/密码登录
  - 社交登录（Google、GitHub等，可选）
  - JWT令牌管理
  - Session管理
  - 内置安全最佳实践
  - 免费额度：50,000 月活用户
- **Supabase PostgreSQL**：云端数据库服务
  - 免费额度：500MB数据库存储
  - 实时数据同步
  - 自动备份
- **Resend**：邮件发送服务（低优先级）
  - 免费额度：3000封邮件/月
  - 邮箱验证、密码重置（后期添加）

### 用户注册流程
1. **邮箱注册**：用户输入邮箱地址和密码
2. **邮箱验证**：发送验证链接到用户邮箱
3. **账户激活**：点击验证链接激活账户
4. **初始积分**：新用户获得500积分（用于体验付费功能）
5. **用户引导**：介绍产品功能和积分使用方式

### 登录系统
- **邮箱/密码登录**：标准登录方式
- **社交登录**：Google OAuth（可选，后期添加）
- **记住我功能**：30天免登录
- **密码重置**：通过邮箱重置密码
- **登录限制**：防暴力破解保护

### 用户权限管理
- **游客用户**：500字符以下免费翻译
- **注册用户**：500字符以下免费翻译 + 初始积分
- **付费用户**：基于积分的翻译服务
- **管理员**：后台管理权限（可选）

---

## 💰 积分系统与付费策略

### 积分制度设计
#### 积分计费规则
- **短文本翻译（≤500字符）**：免费，无需积分
- **长文本翻译（>500字符）**：付费，按字符数消耗积分
- **计费公式**：超出部分字符数 × 0.1积分/字符
- **最小扣费**：50积分（500字符以上的最小扣费）

#### 积分定价体系（美元锚定）
```
积分包规格（USD定价，可配置）：
┌─────────────────────────────────────┐
│ 积分包      价格(USD)  价值   优惠   │
├─────────────────────────────────────┤
│ 1,000积分    $1.99    $1.99   0%    │
│ 5,000积分    $8.99    $9.95   10%   │
│ 10,000积分   $15.99   $19.90  20%   │
│ 25,000积分   $34.99   $49.75  30%   │
│ 50,000积分   $59.99   $99.50  40%   │
└─────────────────────────────────────┘
```

#### 新用户激励
- **注册奖励**：500积分（约$1价值）
- **首次充值奖励**：额外赠送20%积分
- **推荐奖励**：推荐成功注册用户获得200积分

### 付费功能限制
#### 文本翻译限制
- **免费用户**：500字符以下无限次翻译
- **付费用户**：超过500字符部分按积分计费
- **未登录用户**：500字符以下，每天最多10次翻译

#### 未登录用户使用限制详细规格
##### 翻译次数限制
- **每日限制**: 10次翻译请求
- **字符限制**: 每次最多500字符
- **重置时间**: 每日UTC 00:00重置计数

##### 限制实现方式
- **客户端**: localStorage记录翻译次数
- **服务端**: IP地址 + 日期记录翻译次数
- **双重验证**: 防止客户端绕过限制

##### 超限处理
1. **提示信息**: "今日免费翻译次数已用完"
2. **引导注册**: "注册账户获得更多免费额度"
3. **显示优势**: 
   - 注册用户: 无次数限制
   - 500字符以下无限翻译
   - 获得500积分奖励

##### 功能限制
- **文档翻译**: 完全不支持
- **语音播放**: 限制使用
- **翻译历史**: 不保存记录

#### 文档翻译限制
- **免费用户**：仅支持500字符以下的文档（约1页）
- **付费用户**：完整文档翻译，按提取文本字符数计费
- **文档大小限制**：免费用户5MB，付费用户50MB
- **未登录用户**：不支持文档翻译功能

#### 文档翻译功能详细规格
##### 支持的文件格式
- PDF文件 (最高50MB)
- Word文档 (.docx, .doc)
- PowerPoint演示文稿 (.pptx, .ppt)
- 纯文本文件 (.txt)

##### 积分计费逻辑
1. **文件上传**: 免费，不消耗积分
2. **文本提取**: 免费，显示提取的字符数
3. **翻译处理**: 按提取的文本字符数计费
   - 500字符以下: 免费
   - 超出部分: 0.1积分/字符
4. **结果下载**: 免费

##### 用户权限限制
- **未登录用户**: 不支持文档翻译
- **免费用户**: 
  - 文件大小限制: 5MB
  - 文本字符限制: 500字符免费
- **付费用户**: 
  - 文件大小限制: 50MB
  - 按字符数计费，无其他限制

##### 处理流程
1. 用户上传文档
2. 系统提取文本并显示字符数
3. 计算积分消耗并显示预估费用
4. 用户确认后开始翻译
5. 翻译完成后提供下载链接

#### 积分不足处理
1. **提示机制**：翻译前检查积分余额，不足时显示充值提示
2. **充值引导**：一键跳转到积分购买页面
3. **续费优惠**：积分不足时提供优惠充值选项
4. **降级提示**：建议将长文本分段为免费额度内进行翻译

### 付费流程设计
1. **积分检查**：用户发起长文本翻译时检查积分余额
2. **费用预估**：显示预计消耗积分数量和费用
3. **充值引导**：积分不足时显示充值页面链接
4. **支付处理**：通过Stripe处理积分购买
5. **即时充值**：支付成功后立即到账积分
6. **翻译继续**：充值完成后自动继续翻译任务

---

## 💳 支付系统集成

### 支付方案
**技术方案：Creem REST API + Next.js**
- **Creem Checkout**：现代化支付解决方案，使用简单的REST API
- **支持方式**：信用卡、借记卡、数字钱包
- **多币种支持**：美元为主，支持本地货币显示
- **安全合规**：PCI DSS合规，无需处理敏感卡信息
- **成本优势**：仅收取交易费用，无月费

### 支付流程
1. **在Creem控制台创建产品**：预先在 https://creem.io/dashboard/products 创建积分包产品
2. **创建支付会话**：调用 `POST /v1/checkouts` API创建支付会话
3. **跳转支付页面**：重定向到Creem托管支付页面
4. **处理支付结果**：通过Return URL参数或Webhook接收支付结果
5. **积分入账**：支付成功后立即为用户账户充值积分
6. **发送确认**：发送购买确认邮件（后期功能）

### API调用示例
```javascript
// 创建支付会话
const response = await fetch('https://api.creem.io/v1/checkouts', {
  method: 'POST',
  headers: {
    'x-api-key': process.env.CREEM_API_KEY,
    'Content-Type': 'application/json'
  },
  body: JSON.stringify({
    product_id: 'prod_6tW66i0oZM7w1qXReHJrwg', // 在Creem控制台创建的产品ID
    customer_email: user.email,
    success_url: `${origin}/dashboard?purchase=success`,
    cancel_url: `${origin}/pricing?purchase=canceled`,
    request_id: `user_${user.id}_${Date.now()}` // 用于追踪
  })
});

const checkout = await response.json();
// 重定向到 checkout.url
```

### Return URL处理
支付成功后，用户会被重定向到success_url，携带以下参数：
- `checkout_id`: 支付会话ID
- `order_id`: 订单ID  
- `customer_id`: 客户ID
- `product_id`: 产品ID
- `signature`: Creem签名（用于验证安全性）

### 支付安全
- **签名验证**：验证Creem Return URL签名
- **幂等性处理**：防止重复充值
- **交易记录**：完整的支付和积分变动日志
- **争议处理**：支持支付争议管理

---

## 📊 用户控制台功能

### Dashboard页面功能
- **积分余额显示**：当前积分数量和价值
- **使用历史统计**：翻译次数、字符数统计
- **积分使用明细**：详细的积分消耗记录
- **充值历史**：购买记录和发票下载
- **使用量分析**：日/周/月使用量图表

### 用户资料管理
- **基本信息**：邮箱、昵称、头像
- **密码修改**：安全的密码更新流程
- **邮箱验证状态**：验证状态显示和重新验证
- **账户设置**：通知偏好、语言偏好

### 积分管理功能
- **积分购买**：直接跳转到充值页面
- **使用记录**：翻译任务和积分扣费明细
- **余额提醒**：积分不足时的邮件/站内提醒
- **有效期管理**：积分有效期显示（如设置）

---

## 🛡️ 安全与合规

### 数据安全
- **密码加密**：bcrypt哈希存储
- **Session安全**：安全的JWT令牌管理
- **数据传输**：HTTPS强制加密
- **API安全**：Rate Limiting和API密钥保护

### 隐私保护
- **数据最小化**：仅收集必要的用户信息
- **翻译内容**：不存储用户翻译的文本内容
- **日志记录**：仅记录使用统计，不记录敏感内容
- **数据删除**：用户可申请删除账户和所有数据

### 合规要求
- **GDPR合规**：欧盟用户数据保护
- **CCPA合规**：加州用户隐私保护
- **用户协议**：完整的服务条款和隐私政策
- **Cookie政策**：透明的Cookie使用说明

---

## 🧠 核心功能模块

| 模块         | 描述 |
|--------------|------|
| 文本输入框   | 最大支持10000字符，超过500字符显示积分消耗预估 |
| 双向翻译按钮 | 请求后台NLLB API，支持小语种↔英文双向翻译 |
| 语言切换功能 | 一键切换源语言与目标语言，支持所有语言对的双向翻译 |
| 快捷复制/朗读| 英文朗读+原文朗读（可选） |
| SEO增强模块 | 同义关键词落地内容块、FAQ、评论、视频等 |
| 下载/导出翻译| 导出为TXT/PDF |
| 文件翻译     | 支持PDF/Word/PPT/图片文件上传与翻译，自动提取文本并翻译为英文或目标语种 |
| 双向翻译支持 | 所有支持的语言都可以翻译成英文，同时支持英文翻译成对应语言 |
| 语音播放     | 翻译结果支持语音播放（TTS），MVP先支持英文，后续支持小语种 |
| 用户系统     | 邮箱注册/登录、积分管理、使用历史 |
| 积分系统     | 基于字符数的积分计费，支持积分购买和余额管理 |
| 支付系统     | Stripe集成的积分充值功能 |

---

## 🚀 MVP与功能扩展

### MVP首发功能
- **用户身份验证**：邮箱注册/登录、邮箱验证、密码重置
- **积分系统**：积分购买、余额管理、使用计费
- **双向翻译系统**：所有支持语言↔英文双向文本翻译（独立页面）
- **免费额度**：500字符以下免费翻译，超出部分按积分计费
- **语言切换功能**：一键切换源语言与目标语言，无需重新输入
- **语音播放支持**：英文翻译结果语音播放（TTS，优先支持英文）
- **文件翻译**：支持PDF/Word文件上传与双向翻译（免费用户限制500字符）
- **用户控制台**：积分余额、使用历史、充值管理
- **支付系统**：Stripe集成的积分购买功能
- **用户友好界面**：现代化Web界面与交互体验
- **多语言界面**：i18n系统支持
- **完整落地页系统**：每个语言对都有独立的SEO优化页面

### 后续可扩展功能
- 图片OCR翻译、PPT文件翻译
- 小语种TTS语音播放
- 多语种互译、更多文件格式支持
- 企业API服务（API Key授权、限流、计费）
- 团队协作功能
- 批量翻译工具
- 翻译质量评分
- 自定义词典功能

---

## 📝 需求细化与设计补充

### 1. 用户体验与界面细节
- 支持自动检测源语言，用户可通过按钮切换语种，自动检测优先级高于手动选择
- 文件翻译交互：上传后显示文件名、进度条、错误提示和翻译结果提示。翻译结果支持原文-译文对照，内容过长可滚动查看，支持下载新文件。MVP支持最大30~50MB、100页文档，需采用分块/异步处理等技术方案
- 语音播放（TTS）：支持暂停、继续、重播，内嵌播放器，音频格式为mp3或webm
- **积分消耗提示**：长文本翻译前显示预估积分消耗和剩余积分
- **充值引导**：积分不足时显示明显的充值按钮和优惠信息

### 2. Web应用用户体验
- 响应式设计：完美适配桌面端、平板、手机等各种设备
- 直观操作：一键翻译、快速复制、语音播放等便捷功能
- 实时反馈：翻译进度、错误提示、成功状态等用户友好提示
- **登录状态保持**：30天免登录，安全的Session管理
- **积分余额显示**：页面右上角常驻积分余额显示

### 3. SEO与内容运营
- Schema.org结构化数据：MVP阶段静态生成，后续可动态渲染，保证SEO友好
- FAQ、HowTo、SoftwareApplication等Schema：MVP阶段静态维护，后续可接入CMS
- 多语种SEO策略：明确hreflang标签、canonical策略，提升多语种SEO，站点地图自动生成

### 4. 技术实现细节
- NLLB模型部署：MVP阶段采用本地NLLB + Hugging Face云API备选
- 多语种模型切换、模型版本管理：建议通过配置文件管理支持语种和模型版本，便于后续扩展和升级
- 数据存储与隐私：不存储用户翻译历史。文件类翻译结果通过异步方式处理，支持下载链接
- 可扩展性：预留接口支持更多文件格式、语种、TTS引擎
- **用户数据存储**：用户信息、积分余额、使用记录安全存储
- **支付数据安全**：PCI DSS合规的支付数据处理

### 5. 运营与合规
- **积分定价策略**：基于美元锚定的积分体系，支持配置调整
- **免费额度设计**：500字符免费额度平衡用户体验和商业价值
- **新用户激励**：注册赠送积分、首充奖励提升转化率
- 用户协议、隐私政策、合规声明：需提供相应页面，确保合规
- **GDPR/CCPA合规**：用户数据保护和隐私权利实现

### 6. 网站架构优化需求

#### 6.1 首页功能重构
- **当前问题**: 首页直接嵌入文本翻译功能，影响产品展示
- **解决方案**: 
  - 将文本翻译功能独立到 `/text-translate` 页面
  - 首页改为展示多种翻译形式：
    - Text翻译（跳转到 `/text-translate`）
    - Document翻译（跳转到 `/document-translate`）
    - 图片翻译（Coming Soon状态）
  - **用户状态显示**：首页右上角显示登录状态和积分余额

#### 6.2 语言落地页系统
- **功能需求**: 为Supported Languages模块中的每个语言创建完整落地页
- **页面分类**:
  - **已支持语言**: 完整的翻译功能页面（如 `/creole-to-english`）
  - **暂不支持语言**: Coming Soon提示页面
- **SEO要求**: 所有页面需包含完整的Schema.org结构化数据
- **路径规范**: `/{source-language}-to-english` 格式
- **付费功能集成**：语言页面集成积分计费和用户系统

#### 6.3 多语言界面支持 (i18n)
- **功能描述**: 整个网站支持界面语言切换
- **支持语言**: 网站可翻译的小语种（海地克里奥尔语、老挝语、斯瓦希里语、缅甸语等）
- **实现范围**: 
  - 导航栏、按钮、表单等所有UI元素
  - 页面标题、描述文案
  - 错误提示、状态信息
  - **积分系统相关文案**：充值提示、余额显示、计费说明
- **技术方案**: Next.js国际化(i18n)系统 + react-i18next

#### 6.4 Footer链接完善
- **当前问题**: Contact Support、API Documentation等链接导向404
- **需要完善的页面**:
  - Contact Support: 联系方式页面或Coming Soon
  - API Documentation: API文档页面或Coming Soon  
  - Help & FAQ: 帮助文档页面
  - Blog: 博客页面或Coming Soon
  - **新增**：Pricing定价页面、Terms服务条款、Privacy隐私政策

---

## 💾 数据架构设计

### 用户数据模型 (Supabase PostgreSQL)
```typescript
interface User {
  id: string               // Supabase Auth User ID
  email: string
  emailVerified: boolean
  credits: number          // 积分余额
  createdAt: Date
  updatedAt: Date
  profile: {
    name?: string
    avatar?: string
    language: string       // 界面语言偏好
  }
}
```

### 积分交易记录
```typescript
interface CreditTransaction {
  id: string
  userId: string
  type: 'purchase' | 'consume' | 'reward'
  amount: number           // 正数为增加，负数为消费
  balance: number          // 交易后余额
  description: string      // 交易描述
  metadata?: {
    translationId?: string
    stripePaymentId?: string
    characterCount?: number
  }
  createdAt: Date
}
```

### 翻译使用记录
```typescript
interface Translation {
  id: string
  userId?: string          // 可选，游客用户为空
  sourceText: string
  translatedText: string
  sourceLanguage: string
  targetLanguage: string
  characterCount: number
  creditsUsed: number      // 消耗的积分
  method: 'nllb-local' | 'nllb-cloud' | 'mock'
  createdAt: Date
}
```

### 支付记录
```typescript
interface Payment {
  id: string
  userId: string
  creemPaymentId: string   // Creem支付ID
  amount: number           // 美元金额
  credits: number          // 购买的积分数量
  status: 'pending' | 'completed' | 'failed'
  createdAt: Date
  completedAt?: Date
}
```

---

## 💰 技术栈成本分析

### 免费服务层级
- **Frontend & Hosting**: Next.js + Vercel（免费层级）
- **身份验证**: Supabase Auth（50,000 月活用户免费）
- **数据库**: Supabase PostgreSQL（500MB 存储免费）
- **邮件服务**: Resend（3,000封邮件/月免费，低优先级功能）
- **支付处理**: Creem（仅收取交易费用，无月费）

### 预期月度成本
- **基础设施成本**: $0/月
- **交易费用**: 仅在用户购买积分时产生（通常2.9% + $0.30/笔）
- **总月度成本**: $0（除交易费用外）

### 扩展计划
- **Vercel Pro**: $20/月（团队协作、更多构建分钟）
- **Supabase Pro**: $25/月（8GB数据库、更多API调用）
- **成本可控**: 随用户增长按需升级